<!DOCTYPE html>
<html lang="zh-CN">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>"æˆ‘" - ğ€ğğŸğšğ®ğ­ğ®ğ¦ğ§</title>
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
   <link rel="icon" href="https://avatars.githubusercontent.com/u/195545824?v=4">
   <style>
      /* ==================== é¢œè‰²å˜é‡ï¼ˆé›†ä¸­ç®¡ç†ï¼‰==================== */
      :root {
         /* æš—è‰²æ¨¡å¼å…‰æ•ˆï¼šçº¢è‰² */
         --reveal-hi-dark:    255, 0,   0;
         --reveal-mid-dark:   160, 0,   0;
         /* äº®è‰²æ¨¡å¼å…‰æ•ˆï¼šè“ç´«ï¼ˆåŸæš—è‰²é…è‰²ï¼‰ */
         --reveal-hi-light:   180, 205, 255;
         --reveal-mid-light:  108, 143, 255;
         /* å½“å‰æ¨¡å¼ï¼ˆJS å¯åŠ¨æ—¶æ³¨å…¥ï¼‰ */
         --reveal-hi:         255, 0,   0;
         --reveal-mid:        160, 0,   0;
         /* é«˜äº®è‰² */
         --accent:            #f00;
      }

      /* ==================== åŸºç¡€æ ·å¼ ==================== */
      *, *::before, *::after { box-sizing: border-box; }
      * { margin: 0; padding: 0; }

      body {
         background-color: #0d0d0d;
         color: #fff;
         font-family: Arial, sans-serif;
         line-height: 1.6;
         padding: 20px;
         max-width: 1000px;
         margin: 0 auto;
         position: relative;
         min-height: 200vh;
         transition: background-color 0.5s ease, color 0.5s ease;
         overflow-x: hidden;
      }

      /* ==================== ä¸»é¢˜æ ·å¼ ==================== */
      body.dark-mode { background-color: #121212; color: #ffffff; }
      body.light-mode { background-color: #fff; color: #000; }

      body.dark-mode .header { border-bottom-color: #333; }
      body.dark-mode .title { color: #fff; }
      body.dark-mode .summary { color: #ccc; }
      body.dark-mode .date { color: #999; }
      body.dark-mode .tag { background-color: #333; color: #fff; }
      body.dark-mode h1, body.dark-mode h2, body.dark-mode h3,
      body.dark-mode h4, body.dark-mode h5, body.dark-mode h6 {
         border-bottom-color: #333; color: #fff;
      }
      body.dark-mode .comments { border-top-color: #333; }

      body.light-mode .header { border-bottom-color: #ddd; }
      body.light-mode .title { color: #000; }
      body.light-mode .summary { color: #666; }
      body.light-mode .date { color: #777; }
      body.light-mode .tag { background-color: #eee; color: #000; }
      body.light-mode h1, body.light-mode h2, body.light-mode h3,
      body.light-mode h4, body.light-mode h5, body.light-mode h6 {
         border-bottom-color: #ddd; color: #000;
      }
      body.light-mode .comments { border-top-color: #ddd; }

      /* ==================== æ–‡ç« å†…å®¹æ ·å¼ ==================== */
      .header {
         margin-bottom: 9px; padding: 20px; padding-bottom: 3px;
         border-bottom: 1px solid #333;
         transition: border-color 0.5s ease;
         word-wrap: break-word; word-break: break-word; overflow-wrap: break-word;
      }
      .title {
         font-size: 2.5rem; margin-bottom: 3px; color: #fff;
         transition: color 0.5s ease;
         word-wrap: break-word; word-break: break-word; overflow-wrap: break-word;
      }
      .summary {
         font-size: 1.1rem; margin-bottom: 3px; color: #ccc;
         transition: color 0.5s ease;
         word-wrap: break-word; word-break: break-word; overflow-wrap: break-word;
      }
      .date { color: #999; font-size: 0.9rem; margin-bottom: 3px; transition: color 0.5s ease; }
      .tags { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 3px; }
      .tag {
         background-color: #333; color: #fff;
         padding: 2px 10px; border-radius: 3px; font-size: 0.9rem;
         transition: background-color 0.5s ease, color 0.5s ease;
      }
      .content {
         padding: 20px; padding-top: 0px; margin-bottom: 50px;
         transition: color 0.5s ease;
         overflow-x: hidden;
         word-wrap: break-word; word-break: break-word; overflow-wrap: break-word;
      }

      /* ==================== Markdownå†…å®¹æ ·å¼ ==================== */
      .content p { margin-top: 0; margin-bottom: 0.3em; line-height: 1.5; word-wrap: break-word; word-break: break-word; overflow-wrap: break-word; }
      .content h1, .content h2, .content h3,
      .content h4, .content h5, .content h6 {
         margin: 1.5em 0 0.5em; padding-bottom: 10px;
         border-bottom: 1px solid #333;
         transition: border-color 0.5s ease, color 0.5s ease;
         word-wrap: break-word; word-break: break-word; overflow-wrap: break-word;
      }
      .content ul, .content ol { margin: 0.8em 0; padding-left: 2em; }
      .content li { margin: 0.3em 0; line-height: 1.6; word-wrap: break-word; word-break: break-word; overflow-wrap: break-word; }
      .content pre { margin: 1em 0; padding: 1em; background-color: #f5f5f5; border-radius: 4px; overflow-x: auto; white-space: pre; max-width: 100%; }
      body.dark-mode .content pre { background-color: #2d2d2d; color: #f8f8f2; }
      .content code { font-family: 'Consolas', 'Monaco', 'Courier New', monospace; font-size: 0.9em; }
      .content p code { background-color: #f5f5f5; padding: 0.2em 0.4em; border-radius: 3px; word-wrap: break-word; word-break: break-word; overflow-wrap: break-word; }
      body.dark-mode .content p code { background-color: #3a3a3a; color: #f8f8f2; }
      .content blockquote { margin: 1em 0; padding: 0.5em 1em; border-left: 4px solid #ddd; background-color: #f9f9f9; color: #666; border-radius: 5px; word-wrap: break-word; word-break: break-word; overflow-wrap: break-word; }
      body.dark-mode .content blockquote { border-left-color: #555; background-color: #2a2a2a; color: #ccc; }
      .table-wrapper { overflow-x: auto; margin: 20px 0; max-width: 100%; }
      .content table { margin: 1em 0; border-collapse: collapse; width: 100%; max-width: 100%; }
      .content th, .content td { border: 1px solid #ddd; padding: 0.5em 1em; text-align: left; word-wrap: break-word; word-break: break-word; overflow-wrap: break-word; max-width: 300px; }
      .content th { background-color: #f5f5f5; font-weight: 600; }
      body.dark-mode .content th { background-color: #333; border-color: #444; }
      body.dark-mode .content td { border-color: #444; }
      .content img { max-width: 100%; height: auto; margin: 1em 0; border-radius: 4px; display: block; }
      .content hr { margin: 2em 0; border: none; border-top: 1px solid #ddd; }
      .content a { color: #4da6ff; text-decoration: none; border-bottom: 1px dotted rgba(77,166,255,0.5); transition: all 0.3s ease; word-wrap: break-word; word-break: break-word; overflow-wrap: break-word; }
      body.dark-mode .content a { color: #6bb8ff; border-bottom: 1px dotted rgba(107,184,255,0.5); }
      .content a:hover { color: #fff; border-bottom: 1px solid rgba(77,166,255,0.8); background-color: rgba(77,166,255,0.1); }
      body.dark-mode .content a:hover { color: #fff; border-bottom: 1px solid rgba(107,184,255,0.8); background-color: rgba(107,184,255,0.1); }

      /* ==================== è¯„è®ºåŒº ==================== */
      .comments { margin-top: 50px; padding: 20px; border-top: 1px solid #333; transition: border-color 0.5s ease; }

      /* ==================== äºšå…‹åŠ›æµ®åŠ¨æŒ‰é’® ==================== */
      .floating-btn {
         position: fixed; bottom: 30px; right: 30px;
         width: 60px; height: 60px; border-radius: 50%;
         display: flex; justify-content: center; align-items: center;
         cursor: pointer; font-size: 24px; z-index: 1000;
         border: 1px solid rgba(255,255,255,0.12); outline: none;
         background: rgba(20, 20, 20, 0.55);
         backdrop-filter: blur(20px) saturate(180%);
         -webkit-backdrop-filter: blur(20px) saturate(180%);
         transition: background 0.3s ease, border-color 0.3s ease;
      }
      body.light-mode .floating-btn {
         background: rgba(255,255,255,0.55); border-color: rgba(0,0,0,0.1); color: #000;
      }

      /* Revealï¼šfloating-btnï¼ˆé¢œè‰²ç»Ÿä¸€èµ° CSS å˜é‡ï¼‰ */
      .floating-btn::before {
         content: ''; position: absolute; inset: -1px; border-radius: 50%; padding: 1px;
         background: radial-gradient(
            80px circle at var(--rx, -9999px) var(--ry, -9999px),
            rgba(var(--reveal-hi), 0.95),
            rgba(var(--reveal-mid), 0.45) 45%,
            transparent 70%
         );
         -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
         -webkit-mask-composite: xor; mask-composite: exclude;
         pointer-events: none;
      }

      /* ==================== é®ç½© ==================== */
      .menu-mask {
         position: fixed; top: 0; left: 0; width: 100%; height: 100%;
         background-color: rgba(0,0,0,0.3);
         backdrop-filter: blur(2px); -webkit-backdrop-filter: blur(2px);
         z-index: 998; display: none; transition: opacity 0.3s ease;
      }
      .menu-mask.active { display: block; }

      /* ==================== ä¾§è¾¹èœå• wrapper ==================== */
      .side-menu-wrapper {
         position: fixed; bottom: 30px; right: 30px;
         width: 250px; height: 400px; max-width: calc(100vw - 60px);
         border-radius: 12px; z-index: 999;
         display: none; pointer-events: none;
      }
      .side-menu-wrapper.active {
         display: block;
         animation: menuAppear 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
      }
      @keyframes menuAppear {
         0%   { transform: scale(0.1); opacity: 0; }
         100% { transform: scale(1);   opacity: 1; }
      }

      /* wrapper å¤–æ¡† Reveal */
      .side-menu-wrapper::before {
         content: ''; position: absolute; inset: -1px; border-radius: inherit; padding: 1px;
         background: radial-gradient(
            150px circle at var(--rx, -9999px) var(--ry, -9999px),
            rgba(var(--reveal-hi), 0.95),
            rgba(var(--reveal-mid), 0.45) 45%,
            transparent 70%
         );
         -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
         -webkit-mask-composite: xor; mask-composite: exclude;
         pointer-events: none; z-index: 1;
      }

      /* ==================== äºšå…‹åŠ›ä¾§è¾¹èœå• ==================== */
      .side-menu {
         position: relative; width: 100%; height: 100%;
         border-radius: 12px; display: none; flex-direction: row;
         overflow: hidden;
         background: rgba(18, 18, 18, 0.6);
         backdrop-filter: blur(24px) saturate(180%);
         -webkit-backdrop-filter: blur(24px) saturate(180%);
         border: 1px solid rgba(255,255,255,0.1);
         pointer-events: auto;
         transition: background 0.5s ease, border-color 0.5s ease;
      }
      body.light-mode .side-menu { background: rgba(255,255,255,0.6); border-color: rgba(0,0,0,0.08); }
      .side-menu.active { display: flex; }

      /* ==================== èœå•å·¦ä¾§ï¼šç« èŠ‚åˆ—è¡¨ ==================== */
      /* æ—  ::before â€” å…‰æ•ˆå®Œå…¨ç”± Canvas è´Ÿè´£ï¼Œé¿å…ä¸ Canvas é‡å  */
      .menu-left {
         position: relative; width: 200px; padding: 20px;
         overflow-y: auto; scrollbar-width: none;
         background: transparent;
         word-wrap: break-word; word-break: break-word; overflow-wrap: break-word;
      }
      .menu-left::-webkit-scrollbar { display: none; }

      /* ==================== ç« èŠ‚é¡¹ ==================== */
      .chapter-item {
         padding: 10px 0; cursor: pointer;
         color: rgba(255,255,255,0.7);
         transition: color 0.2s, padding-left 0.2s;
         word-wrap: break-word; word-break: break-word; overflow-wrap: break-word;
         position: relative;
      }
      .chapter-item::after {
         content: ''; position: absolute; bottom: 0;
         left: 8px; right: 8px; height: 1px;
         background: rgba(255,255,255,0.3);
      }
      body.light-mode .chapter-item { color: rgba(0,0,0,0.7); }
      body.light-mode .chapter-item::after { background: rgba(0,0,0,0.3); }
      .chapter-item:last-child::after { display: none; }

      .chapter-item.h1-item { padding-left: 0; }
      .chapter-item.h2-item { padding-left: 14px; color: rgba(255,255,255,0.45); font-size: 0.9em; }
      .chapter-item.h3-item { padding-left: 28px; color: rgba(255,255,255,0.3); font-size: 0.85em; }
      body.light-mode .chapter-item.h2-item { color: rgba(0,0,0,0.45); }
      body.light-mode .chapter-item.h3-item { color: rgba(0,0,0,0.3); }

      /* CSS hoverï¼ˆè§†è§‰åé¦ˆï¼Œä¸å½±å“çŠ¶æ€æœºï¼‰ */
      .chapter-item:hover                  { color: var(--accent); }
      .chapter-item.h1-item:hover          { padding-left: 5px; }
      .chapter-item.h2-item:hover          { padding-left: 19px; }
      .chapter-item.h3-item:hover          { padding-left: 33px; }

      /* é«˜äº®ç±»ï¼šäº’æ–¥ï¼ŒåªåŠ å…¶ä¸­ä¸€ä¸ª */
      .chapter-item.current                { color: var(--accent) !important; }
      .chapter-item.hovered                { color: var(--accent) !important; }
      .chapter-item.hovered.h1-item        { padding-left: 5px; }
      .chapter-item.hovered.h2-item        { padding-left: 19px; }
      .chapter-item.hovered.h3-item        { padding-left: 33px; }

      /* ==================== èœå•å³ä¾§ï¼šæŒ‰é’®åŒº ==================== */
      .menu-right {
         position: relative; width: 50px; height: 100%;
         display: flex; flex-direction: column;
         background: rgba(0,0,0,0.2);
         border-left: 1px solid rgba(255,255,255,0.07);
         transition: background 0.5s ease;
      }
      body.light-mode .menu-right { background: rgba(0,0,0,0.05); border-left-color: rgba(0,0,0,0.06); }

      /* menu-right Revealï¼ˆç‹¬ç«‹äº Canvasï¼‰ */
      .menu-right::before {
         content: ''; position: absolute; inset: -1px;
         border-radius: 0 12px 12px 0; padding: 1px;
         background: radial-gradient(
            130px circle at var(--rx, -9999px) var(--ry, -9999px),
            rgba(var(--reveal-hi), 0.7),
            rgba(var(--reveal-mid), 0.3) 45%,
            transparent 70%
         );
         -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
         -webkit-mask-composite: xor; mask-composite: exclude;
         pointer-events: none; z-index: 2;
      }

      .menu-buttons {
         flex: 1; display: flex; flex-direction: column;
         justify-content: space-between; align-items: center;
         padding: 20px 0; width: 100%;
      }
      .menu-btn {
         color: rgba(255,255,255,0.75); background: none; border: none;
         cursor: pointer; transition: all 0.2s; font-size: 20px;
         width: 50px; height: 47px; text-align: center; border-radius: 0;
         display: flex; justify-content: center; align-items: center;
      }
      body.light-mode .menu-btn { color: rgba(0,0,0,0.6); }
      .menu-btn:hover { color: var(--accent); background-color: rgba(255,0,0,0.1); }

      .close-btn {
         height: 50px; background: rgba(0,0,0,0.15);
         color: rgba(255,255,255,0.6); border: none;
         border-top: 1px solid rgba(255,255,255,0.07);
         cursor: pointer; font-size: 16px;
         transition: background 0.2s, color 0.2s; width: 100%;
      }
      body.light-mode .close-btn { background: rgba(0,0,0,0.04); color: rgba(0,0,0,0.5); border-top-color: rgba(0,0,0,0.06); }
      .close-btn:hover { color: var(--accent); background-color: rgba(255,0,0,0.08); }

      /* ==================== Canvas å åŠ å±‚ï¼ˆåˆ†éš”çº¿å‘å…‰ï¼‰ ==================== */
      #menuRevealCanvas {
         position: fixed; pointer-events: none; z-index: 1001;
         opacity: 0; transition: opacity 0.2s;
      }
      #menuRevealCanvas.active { opacity: 1; }

      .header, .floating-btn, .side-menu, .comments {
         user-select: none; -webkit-user-select: none; -webkit-touch-callout: none;
      }
   </style>
</head>

<body class="dark-mode">
   <div class="header">
      <h1 class="title">"æˆ‘"</h1>
      <p class="summary">æš‚æ— ç®€ä»‹</p>
      <div class="date">2026-02-24</div>
      <div class="tags">
         <span class="tag">è®°å½•</span>
         <span class="tag">å›å¿†</span>
      </div>
   </div>

   <div class="content">
      <p>æˆ‘çœŸçš„æœ‰åœ¨å˜,ä¸€ç›´åœ¨å˜<br>
ä¸åƒæ˜¯é‚£ç§çªç„¶çš„,ä¸€ç¬é—´çš„.è€Œæ˜¯ä½ èƒ½å¤Ÿæ„Ÿè§‰åˆ°,æ…¢æ…¢çš„,æ…¢æ…¢çš„.å¾ˆå¤šä¸œè¥¿éƒ½å˜äº†<br>
æ¸æ¸çš„,æˆ‘ä¹Ÿæ·¡æ¼ äº†<br>
æˆ‘æ›¾å¥½åƒå¾ˆå¤©çœŸ,æˆ‘è¿‡å»ä¼¼ä¹ä»€ä¹ˆéƒ½ç›¸ä¿¡,ä»€ä¹ˆéƒ½å¸Œå†€<br>
ç°åœ¨ä¸æ˜¯äº†...</p>
<p>ç›´åˆ°å‡ å¤©å‰å»å¤–å©†å®¶,å¥¹ä»¬åˆæèµ·äº†ä¸€äº›å¾€äº‹.é—®æˆ‘,ç„¶è€Œæˆ‘å´ä»€ä¹ˆä¹Ÿæƒ³ä¸èµ·æ¥<br>
æˆ‘æ˜¯çœŸçš„ä¸è®°å¾—äº†...ä»€ä¹ˆéƒ½è®°ä¸èµ·æ¥</p>
<p>æ®è¯´,äººåœ¨å—åˆ°é‡å¤§æ‰“å‡»çš„æ—¶å€™.å¤§è„‘ä¼šé€‰æ‹©æ€§çš„å¤±å¿†æ¥ä¿æŠ¤ä½ ,æˆ‘åƒæ˜¯è¿™æ ·çš„å—?æˆ‘ä¼¼ä¹ä»€ä¹ˆä¹Ÿä¸åœ¨æ„,ç„¶è€Œå¥½åƒåˆåœ¨æ„ä¸€åˆ‡</p>
<p>"è´Ÿè´£"<br>
Duty,æˆ‘æ²‰é»˜äº†.åŸæ¥æ˜¯å› ä¸ºè´Ÿè´£,ä¹Ÿå°±åƒä½ åœ¨å¯¹ç€ç©ºè°·å˜¶å¼,å´æœŸç›¼ç€èƒ½å¤Ÿå¬åˆ°å›å“<br>
......<br>
ä¸è¿‡èƒ½å¤Ÿè¯´ä»€ä¹ˆå‘¢?è‡³å°‘èƒ½å¤Ÿè¯æ˜ABCæ˜¯ä¸€ä¸ªè´Ÿè´£ä»»çš„äºº,è‡³å°‘èƒ½å¤Ÿè¯´æ˜,ABCå¾ˆæœ‰è´£ä»»å¿ƒ<br>
......</p>
<p>æˆ‘åˆæƒ³åˆ°æˆ‘äº†<br>
æˆ‘æƒ³åˆ°äº†æˆå¹´,æˆ‘æƒ³åˆ°äº†ä¸€ç¾¤äººåœ¨ç¬‘,æˆ‘æƒ³åˆ°äº†"æˆäººç¤¼",æˆ‘æƒ³åˆ°äº†"å­˜åœ¨",æˆ‘æƒ³åˆ°äº†"å®¶äºº",æˆ‘æƒ³åˆ°äº†"Friends"<br>
......<br>
ä¸è¿‡å¥½åƒæ¯ä¸€ä»¶éƒ½ä¸æˆ‘æ¯«æ— å…³ç³»,æˆ‘çªç„¶åˆå¤±è½äº†èµ·æ¥,è¿™æ˜¯å¤±è½å—?å¦‚æœèƒ½å¤Ÿç§°ä¹‹ä¸º"æ˜¯"çš„è¯<br>
æˆ‘åˆå“­äº†...<br>
ä¸è¿‡å€’æ²¡æœ‰çœŸçš„å“­,æˆ‘çš„è„‘å­å·²ç»å“­å®Œäº†.ä½†æ˜¯æˆ‘çš„Bodyè¡¨ç¤ºä¸åƒè¿™ä¸€å¥—,æ²¡åŠæ³•,å°±å¥½åƒè‡ªå·±ç²¾ç¥åˆ†è£‚äº†ä¸€æ ·,åŠæˆªæ˜¯åŠæˆª</p>
<p>?</p>
   </div>

   <div class="comments"></div>

   <button class="floating-btn" id="menuToggle" style="color: #fff">â˜°</button>
   <div class="menu-mask" id="menuMask"></div>

   <div class="side-menu-wrapper" id="sideMenuWrapper">
      <div class="side-menu" id="sideMenu">
         <div class="menu-left" id="chapterList"></div>
         <div class="menu-right">
            <div class="menu-buttons">
               <button class="menu-btn" id="toBottomBtn">â–¼</button>
               <button class="menu-btn" id="middleBtn">â—</button>
               <button class="menu-btn" id="toTopBtn">â–²</button>
            </div>
            <button class="close-btn" id="closeBtn">â•³</button>
         </div>
      </div>
   </div>

   <canvas id="menuRevealCanvas"></canvas>

   <script>
     // ============================================================
     // 0. ä¸»é¢˜ & é¢œè‰²å˜é‡æ³¨å…¥
     // ============================================================
     function applyThemeVars() {
       const isLight = document.body.classList.contains('light-mode');
       document.documentElement.style.setProperty('--reveal-hi',  isLight ? '180,205,255' : '255,0,0');
       document.documentElement.style.setProperty('--reveal-mid', isLight ? '108,143,255' : '160,0,0');
     }
     function applyTheme() {
       const mode = localStorage.getItem('theme') || "dark";
       document.body.classList.toggle('light-mode', mode === 'light');
       document.body.classList.toggle('dark-mode',  mode !== 'light');
       applyThemeVars();
     }
     applyTheme();

     // ============================================================
     // 1. DOM å¼•ç”¨
     // ============================================================
     const menuToggle      = document.getElementById('menuToggle');
     const sideMenuWrapper = document.getElementById('sideMenuWrapper');
     const sideMenu        = document.getElementById('sideMenu');
     const menuMask        = document.getElementById('menuMask');
     const closeBtn        = document.getElementById('closeBtn');
     const toBottomBtn     = document.getElementById('toBottomBtn');
     const middleBtn       = document.getElementById('middleBtn');
     const toTopBtn        = document.getElementById('toTopBtn');
     const chapterList     = document.getElementById('chapterList');
     const menuLeftEl      = document.querySelector('.menu-left');
     const menuRightEl     = document.querySelector('.menu-right');

     // ============================================================
     // 2. æ”¶é›†æ ‡é¢˜
     // ============================================================
     const allHeadings = Array.from(
       document.querySelectorAll('.content h1, .content h2, .content h3')
     ).filter(h => h.textContent.trim() !== '');
     allHeadings.forEach((el, i) => { el.id = `heading-${i}`; });

     // ============================================================
     // 3. é«˜äº®çŠ¶æ€æœº
     //
     //  highlightState ä¸‰ç§å€¼ï¼ˆåŒæ—¶åªå­˜åœ¨ä¸€ç§ï¼‰ï¼š
     //    'page'       â€” é»˜è®¤ï¼Œç”±é¡µé¢æ»šåŠ¨ä½ç½®é©±åŠ¨
     //    'hover'      â€” é¼ æ ‡æ‚¬åœæŸä¸ª itemï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰
     //    'menuScroll' â€” ç”¨æˆ·æ‰‹åŠ¨æ»‘åŠ¨èœå•åˆ—è¡¨
     //
     //  æ ¸å¿ƒè§„åˆ™ï¼š
     //    1. setHighlight() æ˜¯å”¯ä¸€ä¿®æ”¹é«˜äº®çš„å…¥å£
     //    2. hover è¿›å…¥æ—¶é”å®šçŠ¶æ€ï¼Œpage/menuScroll ä¸å¯è¦†ç›–
     //    3. hover ç¦»å¼€æ—¶ç«‹å³æ¢å¤ pageï¼Œä¸è§¦å‘ä»»ä½•é¢å¤–æ»šåŠ¨
     //    4. scrollMenuToCenter() åªç§»åŠ¨åˆ—è¡¨ UIï¼Œä¸æ”¹çŠ¶æ€
     //       ä¸”ä¼šçŸ­æš‚å±è”½ chapterList çš„ scroll äº‹ä»¶ï¼Œ
     //       é˜²æ­¢ç¨‹åºæ»šåŠ¨è¢«è¯¯åˆ¤ä¸º menuScroll
     // ============================================================
     let pageCurrentId  = null;      // é¡µé¢æ»šåŠ¨ç¡®å®šçš„å½“å‰æ ‡é¢˜ id
     let highlightState = 'page';    // 'page' | 'hover' | 'menuScroll'
     let highlightId    = null;      // å½“å‰é«˜äº®çš„ id

     function setHighlight(id, state) {
       highlightState = state;
       highlightId    = id;
       document.querySelectorAll('.chapter-item.current, .chapter-item.hovered')
         .forEach(i => i.classList.remove('current', 'hovered'));
       if (!id) return;
       const item = document.querySelector(`.chapter-item[data-id="${id}"]`);
       if (item) item.classList.add(state === 'page' ? 'current' : 'hovered');
     }

     // æ»šåŠ¨åˆ—è¡¨è®©æŒ‡å®š item å±…ä¸­ï¼ˆçº¯ UIï¼Œä¸æ”¹çŠ¶æ€ï¼‰
     // æ»šåŠ¨æœŸé—´å±è”½ chapterList scroll äº‹ä»¶ï¼Œé˜²æ­¢è¯¯è§¦ menuScroll
     let _suppressMenuScroll      = false;
     let _suppressMenuScrollTimer = null;
     function scrollMenuToCenter(id) {
       const item  = document.querySelector(`.chapter-item[data-id="${id}"]`);
       if (!item) return;
       const contH  = chapterList.clientHeight;
       const target = item.offsetTop - (contH - item.offsetHeight) / 2;
       if (chapterList.scrollHeight <= contH) return;

       _suppressMenuScroll = true;
       chapterList.scrollTo({ top: Math.max(0, target), behavior: 'smooth' });
       clearTimeout(_suppressMenuScrollTimer);
       // smooth åŠ¨ç”»é€šå¸¸ â‰¤ 300msï¼Œç•™ 450ms ä½™é‡
       _suppressMenuScrollTimer = setTimeout(() => { _suppressMenuScroll = false; }, 450);
     }

     // ============================================================
     // 4. ç”Ÿæˆç« èŠ‚å¯¼èˆª
     // ============================================================
     allHeadings.forEach(heading => {
       const item     = document.createElement('div');
       const level    = parseInt(heading.tagName[1]);
       const classMap = { 1: 'h1-item', 2: 'h2-item', 3: 'h3-item' };
       item.className   = `chapter-item ${classMap[level] || 'h1-item'}`;
       item.textContent = heading.textContent;
       item.dataset.id  = heading.id;

       item.addEventListener('click', (e) => {
         e.stopPropagation();
         heading.scrollIntoView({ behavior: 'smooth', block: 'start' });
         closeMenu();
       });

       // hoverï¼ˆä»…æ¡Œé¢é¼ æ ‡ï¼‰
       item.addEventListener('pointerenter', (e) => {
         if (e.pointerType !== 'mouse') return;
         setHighlight(item.dataset.id, 'hover');
         scheduleHoverScroll(item.dataset.id);
       });
       item.addEventListener('pointerleave', (e) => {
         if (e.pointerType !== 'mouse') return;
         // ç¦»å¼€ï¼šç«‹å³æ¢å¤ pageï¼Œä¸æ»šåŠ¨ï¼ˆé¿å…ä¸ scrollMenuToCenter å¾ªç¯ï¼‰
         clearTimeout(_hoverScrollTimer);
         setHighlight(pageCurrentId, 'page');
       });

       chapterList.appendChild(item);
     });

     // hover å±…ä¸­é˜²æŠ–ï¼ˆ300msï¼‰ï¼Œåªåœ¨ä»å¤„äºåŒä¸€ hover æ—¶æ‰§è¡Œ
     let _hoverScrollTimer = null;
     function scheduleHoverScroll(id) {
       clearTimeout(_hoverScrollTimer);
       _hoverScrollTimer = setTimeout(() => {
         if (highlightState === 'hover' && highlightId === id) {
           scrollMenuToCenter(id);
         }
       }, 300);
     }

     // ============================================================
     // 5. é¡µé¢æ»šåŠ¨ â†’ æ›´æ–° pageCurrentId
     // ============================================================
     function updateActiveHeading() {
       if (!allHeadings.length) return;
       let current = allHeadings[0];
       for (const h of allHeadings) {
         if (h.getBoundingClientRect().top + window.scrollY <= window.scrollY + 80)
           current = h;
         else break;
       }
       if (current.id === pageCurrentId) return;
       pageCurrentId = current.id;
       // hover æœŸé—´ä¸è¦†ç›–é«˜äº®ï¼ŒpageCurrentId å·²æ›´æ–°å¤‡ç”¨
       if (highlightState !== 'hover') {
         setHighlight(pageCurrentId, 'page');
         if (sideMenuWrapper.classList.contains('active') && highlightState !== 'menuScroll') {
           scrollMenuToCenter(pageCurrentId);
         }
       }
     }

     // é¡µé¢æ»šåŠ¨åœæ­¢åå†æ¬¡å±…ä¸­ï¼ˆé˜²æŠ– 250msï¼‰
     let _pageScrollStopTimer = null;
     function onPageScroll() {
       updateActiveHeading();
       if (!sideMenuWrapper.classList.contains('active')) return;
       if (highlightState === 'hover' || highlightState === 'menuScroll') return;
       clearTimeout(_pageScrollStopTimer);
       _pageScrollStopTimer = setTimeout(() => {
         if (highlightState !== 'hover' && pageCurrentId) {
           scrollMenuToCenter(pageCurrentId);
         }
       }, 250);
     }
     window.addEventListener('scroll', onPageScroll, { passive: true });

     // ============================================================
     // 6. èœå•åˆ—è¡¨æ‰‹åŠ¨æ»šåŠ¨ â†’ menuScroll çŠ¶æ€
     // ============================================================
     let _menuScrollStopTimer = null;
     chapterList.addEventListener('scroll', () => {
       if (_suppressMenuScroll) return; // ç¨‹åºè§¦å‘çš„æ»šåŠ¨ï¼Œå¿½ç•¥
       if (highlightState === 'hover')  return; // hover æœŸé—´å±è”½

       highlightState = 'menuScroll';
       clearTimeout(_menuScrollStopTimer);
       _menuScrollStopTimer = setTimeout(() => {
         // æ‰¾æœ€é è¿‘åˆ—è¡¨ä¸­å¿ƒçš„ item
         const items   = chapterList.querySelectorAll('.chapter-item');
         const contR   = chapterList.getBoundingClientRect();
         const centerY = contR.top + contR.height / 2;
         let best = null, bestDist = Infinity;
         items.forEach(it => {
           const r = it.getBoundingClientRect();
           const d = Math.abs(r.top + r.height / 2 - centerY);
           if (d < bestDist) { bestDist = d; best = it; }
         });
         if (!best) return;
         const centerId = best.dataset.id;
         scrollMenuToCenter(centerId);
         // ç­‰å±…ä¸­åŠ¨ç”»å®Œæˆåå†é«˜äº®ï¼Œç¡®è®¤æ²¡è¢« hover æ‰“æ–­
         setTimeout(() => {
           if (highlightState !== 'hover') {
             pageCurrentId = centerId; // åŒæ­¥ï¼Œä¿æŒä¸€è‡´
             setHighlight(centerId, 'page');
           }
         }, 460);
       }, 300);
     }, { passive: true });

     // ============================================================
     // 7. ç§»åŠ¨ç«¯è§¦æ‘¸å…œåº•ï¼šæ¸…é™¤ hover æ®‹ç•™
     // ============================================================
     function clearHoverFallback() {
       if (highlightState !== 'hover') return;
       clearTimeout(_hoverScrollTimer);
       setHighlight(pageCurrentId, 'page');
     }
     chapterList.addEventListener('touchend',    clearHoverFallback);
     chapterList.addEventListener('touchcancel', clearHoverFallback);
     chapterList.addEventListener('pointerup', (e) => {
       if (e.pointerType !== 'mouse') clearHoverFallback();
     });

     // ============================================================
     // 8. èœå•å¼€å…³
     // ============================================================
     function openMenu() {
       sideMenuWrapper.classList.add('active');
       sideMenu.classList.add('active');
       menuMask.classList.add('active');
       menuToggle.style.display = 'none';
       setTimeout(() => {
         const id = highlightState === 'hover' ? highlightId : pageCurrentId;
         if (id) scrollMenuToCenter(id);
       }, 50);
     }
     function closeMenu() {
       sideMenuWrapper.classList.remove('active');
       sideMenu.classList.remove('active');
       menuMask.classList.remove('active');
       menuToggle.style.display = 'flex';
       clearTimeout(_hoverScrollTimer);
       if (highlightState === 'hover') setHighlight(pageCurrentId, 'page');
     }

     menuToggle.addEventListener('click',  (e) => { e.stopPropagation(); openMenu(); });
     closeBtn.addEventListener('click',    (e) => { e.stopPropagation(); closeMenu(); });
     menuMask.addEventListener('click',    (e) => { e.stopPropagation(); closeMenu(); });
     sideMenu.addEventListener('click',    (e) => e.stopPropagation());

     toBottomBtn.addEventListener('click', (e) => { e.stopPropagation(); window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' }); closeMenu(); });
     middleBtn.addEventListener('click',   (e) => { e.stopPropagation(); window.scrollTo({ top: (document.documentElement.scrollHeight - window.innerHeight) / 2, behavior: 'smooth' }); closeMenu(); });
     toTopBtn.addEventListener('click',    (e) => { e.stopPropagation(); window.scrollTo({ top: 0, behavior: 'smooth' }); closeMenu(); });

     // ============================================================
     // 9. æ»šåŠ¨è¿›åº¦æŒ‡ç¤ºå™¨
     // ============================================================
     function updateProgress() {
       const sh  = document.documentElement.scrollHeight - window.innerHeight;
       const pct = sh > 0 ? Math.min(window.scrollY / sh, 1) : 0;
       menuToggle.style.backgroundColor = `rgb(${Math.floor(pct * 255)},0,0)`;
       menuToggle.style.boxShadow = 'none';
     }
     window.addEventListener('scroll', updateProgress, { passive: true });
     window.addEventListener('resize', updateProgress, { passive: true });
     updateProgress();

     // åˆå§‹é«˜äº®
     if (allHeadings.length) {
       pageCurrentId = allHeadings[0].id;
       setHighlight(pageCurrentId, 'page');
     }

     // ============================================================
     // 10. Reveal Highlightï¼ˆä»…æ¡Œé¢ï¼‰
     // ============================================================
     const isDesktop = window.matchMedia('(hover: hover) and (pointer: fine)').matches;
     if (isDesktop) {

     const canvas = document.getElementById('menuRevealCanvas');
     const ctx    = canvas.getContext('2d');

     function resizeCanvas() {
       if (!sideMenuWrapper.classList.contains('active')) return;
       const r = menuLeftEl.getBoundingClientRect();
       canvas.width = r.width; canvas.height = r.height;
       canvas.style.left = r.left + 'px'; canvas.style.top = r.top + 'px';
     }

     function getRevealColors() {
       const s = getComputedStyle(document.documentElement);
       return {
         hi:  s.getPropertyValue('--reveal-hi').trim()  || '255,0,0',
         mid: s.getPropertyValue('--reveal-mid').trim() || '160,0,0',
       };
     }

     function drawDividerGlow(mouseX, mouseY) {
       ctx.clearRect(0, 0, canvas.width, canvas.height);
       if (!sideMenuWrapper.classList.contains('active')) return;
       const { hi, mid } = getRevealColors();
       const mr     = menuLeftEl.getBoundingClientRect();
       const radius = 80;
       const mdx = Math.max(mr.left - mouseX, 0, mouseX - mr.right);
       const mdy = Math.max(mr.top  - mouseY, 0, mouseY - mr.bottom);
       if (Math.hypot(mdx, mdy) > radius) return;

       menuLeftEl.querySelectorAll('.chapter-item:not(:last-child)').forEach(item => {
         const ir       = item.getBoundingClientRect();
         const lineY    = ir.bottom - mr.top;
         const lineL    = ir.left   - mr.left + 8;
         const lineR    = ir.right  - mr.left - 8;
         const nearestX = Math.max(lineL, Math.min(mouseX - mr.left, lineR));
         const dist     = Math.hypot(mouseX - mr.left - nearestX, mouseY - mr.top - lineY);
         if (dist > radius) return;

         const intensity = 1 - dist / radius;
         const gx   = mouseX - mr.left;
         const grad = ctx.createRadialGradient(gx, lineY, 0, gx, lineY, radius);
         grad.addColorStop(0,   `rgba(${hi},${0.9 * intensity})`);
         grad.addColorStop(0.4, `rgba(${mid},${0.4 * intensity})`);
         grad.addColorStop(1,   `rgba(${mid},0)`);
         ctx.beginPath();
         ctx.moveTo(lineL, lineY); ctx.lineTo(lineR, lineY);
         ctx.lineWidth = 1; ctx.strokeStyle = grad; ctx.stroke();
       });
     }

     // revealTargetsï¼šå»æ‰ menuLeftElï¼ˆCanvas ä»£åŠ³ï¼‰
     const revealTargets = [
       { el: menuToggle,      range: 60, alwaysOn: true  },
       { el: sideMenuWrapper, range: 80, alwaysOn: false },
       { el: menuRightEl,     range: 80, alwaysOn: false },
     ];

     function clearAllReveal() {
       revealTargets.forEach(({ el }) => {
         el?.style.setProperty('--rx', '-9999px');
         el?.style.setProperty('--ry', '-9999px');
       });
       ctx.clearRect(0, 0, canvas.width, canvas.height);
       canvas.classList.remove('active');
     }

     function handleMove(e) {
       if (e.pointerType && e.pointerType !== 'mouse') return;
       const menuActive = sideMenuWrapper.classList.contains('active');
       revealTargets.forEach(({ el, range, alwaysOn }) => {
         if (!el) return;
         if (!alwaysOn && !menuActive) {
           el.style.setProperty('--rx', '-9999px'); el.style.setProperty('--ry', '-9999px'); return;
         }
         const r  = el.getBoundingClientRect();
         const dx = Math.max(r.left - e.clientX, 0, e.clientX - r.right);
         const dy = Math.max(r.top  - e.clientY, 0, e.clientY - r.bottom);
         if (Math.sqrt(dx*dx + dy*dy) <= range) {
           el.style.setProperty('--rx', (e.clientX - r.left) + 'px');
           el.style.setProperty('--ry', (e.clientY - r.top)  + 'px');
         } else {
           el.style.setProperty('--rx', '-9999px'); el.style.setProperty('--ry', '-9999px');
         }
       });
       if (menuActive) { resizeCanvas(); canvas.classList.add('active'); drawDividerGlow(e.clientX, e.clientY); }
     }

     document.addEventListener('pointermove',  handleMove);
     document.addEventListener('mousemove',    handleMove);
     document.addEventListener('pointerup',    handleMove);
     document.addEventListener('mouseup',      handleMove);
     document.addEventListener('pointerleave', clearAllReveal);
     document.addEventListener('mouseleave',   clearAllReveal);
     window.addEventListener('blur',           clearAllReveal);
     window.addEventListener('resize',         resizeCanvas);

     } // end isDesktop
   </script>
</body>
</html>