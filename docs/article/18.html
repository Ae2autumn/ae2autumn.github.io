<!DOCTYPE html>
<html lang="zh-CN">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>"æˆ‘" - ğ€ğğŸğšğ®ğ­ğ®ğ¦ğ§</title>
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
   <link rel="icon" href="https://avatars.githubusercontent.com/u/195545824?v=4">
   <style>
      /* ==================== åŸºç¡€æ ·å¼ ==================== */
      *, *::before, *::after {
         box-sizing: border-box;
      }

      * {
         margin: 0;
         padding: 0;
      }

      body {
         background-color: #0d0d0d;
         color: #fff;
         font-family: Arial, sans-serif;
         line-height: 1.6;
         padding: 20px;
         max-width: 1000px;
         margin: 0 auto;
         position: relative;
         transition: background-color 0.5s ease, color 0.5s ease;
         overflow-x: hidden;
         /* ç»Ÿä¸€æ–­è¯ï¼Œé¿å…å„å­å…ƒç´ é‡å¤å£°æ˜ */
         word-wrap: break-word;
         word-break: break-word;
         overflow-wrap: break-word;
      }

      /* ==================== ä¸»é¢˜é¢œè‰²å˜é‡ ==================== */
      body.dark-mode {
         background-color: #121212;
         color: #ffffff;
         --reveal-hi:  255, 0, 0;
         --reveal-mid: 180, 30, 30;
      }

      body.light-mode {
         background-color: #fff;
         color: #000;
         --reveal-hi:  80, 80, 180;
         --reveal-mid: 60, 60, 160;
      }

      body.dark-mode .header { border-bottom-color: #333; }
      body.dark-mode .title { color: #fff; }
      body.dark-mode .summary { color: #ccc; }
      body.dark-mode .date { color: #999; }
      body.dark-mode .tag { background-color: #333; color: #fff; }
      body.dark-mode h1, body.dark-mode h2, body.dark-mode h3,
      body.dark-mode h4, body.dark-mode h5, body.dark-mode h6 {
         border-bottom-color: #333;
         color: #fff;
      }
      body.dark-mode .comments { border-top-color: #333; }

      body.light-mode .header { border-bottom-color: #ddd; }
      body.light-mode .title { color: #000; }
      body.light-mode .summary { color: #666; }
      body.light-mode .date { color: #777; }
      body.light-mode .tag { background-color: #eee; color: #000; }
      body.light-mode h1, body.light-mode h2, body.light-mode h3,
      body.light-mode h4, body.light-mode h5, body.light-mode h6 {
         border-bottom-color: #ddd;
         color: #000;
      }
      body.light-mode .comments { border-top-color: #ddd; }

      /* ==================== Reveal ::before å…¬å…±ç»“æ„ ==================== */
      /* æ‰€æœ‰ Reveal è¾¹æ¡†å±‚å…±äº«çš„åŸºç¡€æ ·å¼ï¼Œå„å…ƒç´ åªè¦†ç›– border-radius å’Œæ¸å˜åŠå¾„ */
      .side-menu-wrapper::before,
      .menu-left::before,
      .menu-right::before,
      .floating-btn::before {
         content: '';
         position: absolute;
         inset: -1px;
         padding: 1px;
         -webkit-mask:
            linear-gradient(#fff 0 0) content-box,
            linear-gradient(#fff 0 0);
         -webkit-mask-composite: xor;
         mask-composite: exclude;
         pointer-events: none;
         z-index: 2;
      }

      /* ==================== æ–‡ç« å†…å®¹æ ·å¼ ==================== */
      .header {
         margin-bottom: 9px;
         padding: 20px;
         padding-bottom: 3px;
         border-bottom: 1px solid #333;
         transition: border-color 0.5s ease;
      }

      .title {
         font-size: 2.5rem;
         margin-bottom: 3px;
         color: #fff;
         transition: color 0.5s ease;
      }

      .summary {
         font-size: 1.1rem;
         margin-bottom: 3px;
         color: #ccc;
         transition: color 0.5s ease;
      }

      .date {
         color: #999;
         font-size: 0.9rem;
         margin-bottom: 3px;
         transition: color 0.5s ease;
      }

      .tags {
         display: flex;
         flex-wrap: wrap;
         gap: 10px;
         margin-bottom: 3px;
      }

      .tag {
         background-color: #333;
         color: #fff;
         padding: 2px 10px;
         border-radius: 3px;
         font-size: 0.9rem;
         transition: background-color 0.5s ease, color 0.5s ease;
      }

      .content {
         padding: 20px;
         padding-top: 0px;
         margin-bottom: 50px;
         transition: color 0.5s ease;
         overflow-x: hidden;
      }

      /* ==================== Markdownå†…å®¹æ ·å¼ ==================== */
      .content p {
         margin-top: 0;
         margin-bottom: 0.3em;
         line-height: 1.5;
      }

      .content h1, .content h2, .content h3,
      .content h4, .content h5, .content h6 {
         margin: 1.5em 0 0.5em;
         padding-bottom: 10px;
         border-bottom: 1px solid #333;
         transition: border-color 0.5s ease, color 0.5s ease;
      }

      .content ul, .content ol {
         margin: 0.8em 0;
         padding-left: 2em;
      }

      .content li {
         margin: 0.3em 0;
         line-height: 1.6;
      }

      .content pre {
         margin: 1em 0;
         padding: 1em;
         background-color: #f5f5f5;
         border-radius: 4px;
         overflow-x: auto;
         white-space: pre;
         max-width: 100%;
      }

      body.dark-mode .content pre { background-color: #2d2d2d; color: #f8f8f2; }

      .content code {
         font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
         font-size: 0.9em;
      }

      .content p code {
         background-color: #f5f5f5;
         padding: 0.2em 0.4em;
         border-radius: 3px;
      }

      body.dark-mode .content p code { background-color: #3a3a3a; color: #f8f8f2; }

      .content blockquote {
         margin: 1em 0;
         padding: 0.5em 1em;
         border-left: 4px solid #ddd;
         background-color: #f9f9f9;
         color: #666;
         border-radius: 5px;
      }

      body.dark-mode .content blockquote { border-left-color: #555; background-color: #2a2a2a; color: #ccc; }

      .table-wrapper { overflow-x: auto; margin: 20px 0; max-width: 100%; }

      .content table {
         margin: 1em 0;
         border-collapse: collapse;
         width: 100%;
         max-width: 100%;
      }

      .content th, .content td {
         border: 1px solid #ddd;
         padding: 0.5em 1em;
         text-align: left;
         max-width: 300px;
      }

      .content th { background-color: #f5f5f5; font-weight: 600; }
      body.dark-mode .content th { background-color: #333; border-color: #444; }
      body.dark-mode .content td { border-color: #444; }

      .content img { max-width: 100%; height: auto; margin: 1em 0; border-radius: 4px; display: block; }
      .content hr { margin: 2em 0; border: none; border-top: 1px solid #ddd; }

      .content a {
         color: #4da6ff;
         text-decoration: none;
         border-bottom: 1px dotted rgba(77, 166, 255, 0.5);
         transition: all 0.3s ease;
      }

      body.dark-mode .content a { color: #6bb8ff; border-bottom: 1px dotted rgba(107, 184, 255, 0.5); }

      .content a:hover {
         color: #fff;
         border-bottom: 1px solid rgba(77, 166, 255, 0.8);
         background-color: rgba(77, 166, 255, 0.1);
      }

      body.dark-mode .content a:hover {
         color: #fff;
         border-bottom: 1px solid rgba(107, 184, 255, 0.8);
         background-color: rgba(107, 184, 255, 0.1);
      }

      /* ==================== è¯„è®ºåŒº ==================== */
      .comments {
         margin-top: 50px;
         padding: 20px;
         border-top: 1px solid #333;
         transition: border-color 0.5s ease;
      }

      /* ==================== äºšå…‹åŠ›æµ®åŠ¨æŒ‰é’® ==================== */
      .floating-btn {
         position: fixed;
         bottom: 30px;
         right: 30px;
         width: 60px;
         height: 60px;
         border-radius: 50%;
         display: flex;
         justify-content: center;
         align-items: center;
         cursor: pointer;
         font-size: 24px;
         z-index: 1000;
         border: 1px solid rgba(255, 255, 255, 0.12);
         outline: none;
         /* äºšå…‹åŠ›ï¼šæ¨¡ç³ŠèƒŒæ™¯ + åŠé€æ˜ */
         background: rgba(20, 20, 20, 0.55);
         backdrop-filter: blur(20px) saturate(180%);
         -webkit-backdrop-filter: blur(20px) saturate(180%);
         transition: background 0.3s ease, border-color 0.3s ease;
      }

      body.light-mode .floating-btn {
         background: rgba(255, 255, 255, 0.55);
         border-color: rgba(0, 0, 0, 0.1);
         color: #000;
      }

      /* ==================== é®ç½© ==================== */
      .menu-mask {
         position: fixed;
         top: 0;
         left: 0;
         width: 100%;
         height: 100%;
         background-color: rgba(0, 0, 0, 0.3);
         backdrop-filter: blur(2px);
         -webkit-backdrop-filter: blur(2px);
         z-index: 998;
         display: none;
         transition: opacity 0.3s ease;
      }
      .menu-mask.active { display: block; }

      /* ==================== äºšå…‹åŠ›ä¾§è¾¹èœå• wrapper ==================== */
      .side-menu-wrapper {
         position: fixed;
         bottom: 30px;
         right: 30px;
         width: 250px;
         height: 400px;
         max-width: calc(100vw - 60px);
         border-radius: 12px;
         z-index: 999;
         display: none;
         pointer-events: none;
      }

      .side-menu-wrapper.active {
         display: block;
         animation: menuAppear 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
      }

      @keyframes menuAppear {
         0%   { transform: scale(0.1); opacity: 0; }
         100% { transform: scale(1);   opacity: 1; }
      }

      /* Reveal è¾¹æ¡†å±‚ - ä»…æ¡Œé¢ç«¯æ˜¾ç¤º */
      .side-menu-wrapper::before {
         border-radius: inherit;
         background: radial-gradient(
            150px circle at var(--rx, -9999px) var(--ry, -9999px),
            rgba(var(--reveal-hi),  0.95),
            rgba(var(--reveal-mid), 0.45) 45%,
            transparent 70%
         );
         /* ç§»åŠ¨ç«¯éšè— Reveal è¾¹æ¡†ï¼Œæ˜¾ç¤ºæ™®é€šè¾¹æ¡† */
         opacity: 0;
      }

      /* æ¡Œé¢ç«¯æ¿€æ´» Reveal è¾¹æ¡† */
      body.is-desktop .side-menu-wrapper::before {
         opacity: 1;
      }

      /* ==================== äºšå…‹åŠ›ä¾§è¾¹èœå• ==================== */
      .side-menu {
         position: relative;
         width: 100%;
         height: 100%;
         border-radius: 12px;
         display: none;
         flex-direction: row;
         overflow: hidden;
         background: rgba(18, 18, 18, 0.6);
         backdrop-filter: blur(24px) saturate(180%);
         -webkit-backdrop-filter: blur(24px) saturate(180%);
         /* ç§»åŠ¨ç«¯ï¼šæ˜¾ç¤ºå®Œæ•´è¾¹æ¡† */
         border: 1px solid rgba(255, 255, 255, 0.18);
         pointer-events: auto;
         transition: background 0.5s ease, border-color 0.5s ease;
      }

      body.light-mode .side-menu {
         background: rgba(255, 255, 255, 0.6);
         border-color: rgba(0, 0, 0, 0.12);
      }

      /* æ¡Œé¢ç«¯ï¼šè¾¹æ¡†å¼±åŒ–ï¼Œç”± Reveal ä»£æ›¿ */
      body.is-desktop .side-menu {
         border-color: rgba(255, 255, 255, 0.07);
      }

      body.is-desktop.light-mode .side-menu {
         border-color: rgba(0, 0, 0, 0.05);
      }

      .side-menu.active {
         display: flex;
      }

      /* ==================== èœå•å·¦ä¾§ï¼šç« èŠ‚åˆ—è¡¨ ==================== */
      .menu-left {
         position: relative;
         width: 200px;
         padding: 20px;
         overflow-y: auto;
         scrollbar-width: none;
         background: transparent;
      }

      .menu-left::-webkit-scrollbar { display: none; }

      /* menu-left Reveal è¾¹æ¡† - ä»…æ¡Œé¢ */
      .menu-left::before {
         border-radius: 12px 0 0 12px;
         background: radial-gradient(
            60px circle at var(--rx, -9999px) var(--ry, -9999px),
            rgba(var(--reveal-hi),  0.9),
            rgba(var(--reveal-mid), 0.4) 45%,
            transparent 70%
         );
         opacity: 0;
      }

      body.is-desktop .menu-left::before {
         opacity: 1;
      }

      /* Canvas å åŠ å±‚ */
      #menuRevealCanvas {
         position: fixed;
         pointer-events: none;
         z-index: 1001;
         opacity: 0;
         transition: opacity 0.2s;
      }
      #menuRevealCanvas.active { opacity: 1; }

      /* ==================== ç« èŠ‚é¡¹ ==================== */
      .chapter-item {
         padding: 10px 0;
         cursor: pointer;
         color: rgba(255, 255, 255, 0.7);
         transition: color 0.2s, padding-left 0.2s;
         position: relative;
      }

      /* åˆ†å‰²çº¿ï¼šç§»åŠ¨ç«¯æ˜¾ç¤ºï¼Œæ¡Œé¢ç«¯éšè—ï¼ˆç”± Canvas å…‰æ•ˆä»£æ›¿ï¼‰ */
      .chapter-item::after {
         content: '';
         position: absolute;
         bottom: 0;
         left: 8px;
         right: 8px;
         height: 1px;
         background: rgba(255, 255, 255, 0.3);
         transition: opacity 0.3s;
      }

      body.light-mode .chapter-item::after {
         background: rgba(0, 0, 0, 0.3);
      }

      /* æ¡Œé¢ç«¯éšè—åˆ†å‰²çº¿ */
      body.is-desktop .chapter-item::after {
         opacity: 0;
      }

      .chapter-item:last-child::after { display: none; }

      .chapter-item.h1-item { padding-left: 0; }
      .chapter-item.h2-item { padding-left: 14px; color: rgba(255,255,255,0.45); font-size: 0.9em; }
      .chapter-item.h3-item { padding-left: 28px; color: rgba(255,255,255,0.3);  font-size: 0.85em; }

      body.light-mode .chapter-item { color: rgba(0,0,0,0.7); }
      body.light-mode .chapter-item.h2-item { color: rgba(0,0,0,0.45); }
      body.light-mode .chapter-item.h3-item { color: rgba(0,0,0,0.3); }

      /* æ¡Œé¢ç«¯ hover çº¢è‰² */
      body.is-desktop .chapter-item:hover { color: #f00; }
      body.is-desktop .chapter-item.h1-item:hover { padding-left: 5px; }
      body.is-desktop .chapter-item.h2-item:hover { padding-left: 19px; }
      body.is-desktop .chapter-item.h3-item:hover { padding-left: 33px; }

      /* currentï¼šæ»šåŠ¨è¿½è¸ªé«˜äº® */
      .chapter-item.current { color: red !important; }
      /* hoveredï¼šé¼ æ ‡æ‚¬åœè¦†ç›–ï¼ŒåŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªé«˜äº® */
      .chapter-item.hovered { color: red !important; }

      /* ==================== èœå•å³ä¾§ï¼šæŒ‰é’®åŒº ==================== */
      .menu-right {
         position: relative;
         width: 50px;
         height: 100%;
         display: flex;
         flex-direction: column;
         background: rgba(0, 0, 0, 0.2);
         /* ç§»åŠ¨ç«¯ï¼šæ˜¾ç¤ºåˆ†éš”çº¿ */
         border-left: 1px solid rgba(255, 255, 255, 0.15);
         transition: background 0.5s ease, border-color 0.5s ease;
      }

      body.light-mode .menu-right {
         background: rgba(0, 0, 0, 0.05);
         border-left-color: rgba(0, 0, 0, 0.1);
      }

      /* æ¡Œé¢ç«¯ï¼šåˆ†éš”çº¿å¼±åŒ–ï¼Œç”± Reveal ä»£æ›¿ */
      body.is-desktop .menu-right {
         border-left-color: rgba(255, 255, 255, 0.05);
      }

      body.is-desktop.light-mode .menu-right {
         border-left-color: rgba(0, 0, 0, 0.04);
      }

      /* menu-right Reveal è¾¹æ¡† - ä»…æ¡Œé¢ */
      .menu-right::before {
         border-radius: 0 12px 12px 0;
         background: radial-gradient(
            130px circle at var(--rx, -9999px) var(--ry, -9999px),
            rgba(var(--reveal-hi),  0.7),
            rgba(var(--reveal-mid), 0.3) 45%,
            transparent 70%
         );
         opacity: 0;
      }

      body.is-desktop .menu-right::before {
         opacity: 1;
      }

      .menu-buttons {
         flex: 1;
         display: flex;
         flex-direction: column;
         justify-content: space-between;
         align-items: center;
         padding: 20px 0;
         width: 100%;
      }

      .menu-btn {
         color: rgba(255, 255, 255, 0.75);
         background: none;
         border: none;
         cursor: pointer;
         transition: all 0.2s;
         font-size: 20px;
         width: 50px;
         height: 47px;
         text-align: center;
         border-radius: 0;
         display: flex;
         justify-content: center;
         align-items: center;
      }

      body.light-mode .menu-btn { color: rgba(0, 0, 0, 0.6); }
      .menu-btn:hover { color: #f00; background-color: rgba(255, 0, 0, 0.1); }

      .close-btn {
         height: 50px;
         background: rgba(0, 0, 0, 0.15);
         color: rgba(255, 255, 255, 0.6);
         border: none;
         /* ç§»åŠ¨ç«¯ï¼šæ˜¾ç¤ºä¸Šè¾¹æ¡† */
         border-top: 1px solid rgba(255, 255, 255, 0.1);
         cursor: pointer;
         font-size: 16px;
         transition: background 0.2s, color 0.2s, border-color 0.2s;
         width: 100%;
      }

      body.light-mode .close-btn {
         background: rgba(0, 0, 0, 0.04);
         color: rgba(0, 0, 0, 0.5);
         border-top-color: rgba(0, 0, 0, 0.08);
      }

      /* æ¡Œé¢ç«¯ï¼šä¸Šè¾¹æ¡†å¼±åŒ– */
      body.is-desktop .close-btn {
         border-top-color: rgba(255, 255, 255, 0.05);
      }

      body.is-desktop.light-mode .close-btn {
         border-top-color: rgba(0, 0, 0, 0.04);
      }

      .close-btn:hover { color: #f00; background-color: rgba(255, 0, 0, 0.08); }

      /* ==================== Revealï¼šfloating-btn ==================== */
      .floating-btn::before {
         border-radius: 50%;
         background: radial-gradient(
            80px circle at var(--rx, -9999px) var(--ry, -9999px),
            rgba(var(--reveal-hi),  0.95),
            rgba(var(--reveal-mid), 0.45) 45%,
            transparent 70%
         );
      }

      .header, .floating-btn, .side-menu, .comments {
         user-select: none;
         -webkit-user-select: none;
         -webkit-touch-callout: none;
      }
      
   </style>
</head>

<body class="dark-mode">
   <div class="header">
      <h1 class="title">"æˆ‘"</h1>
      <p class="summary">æš‚æ— ç®€ä»‹</p>
      <div class="date">2026-02-24</div>
      <div class="tags">
         <span class="tag">è®°å½•</span>
         <span class="tag">å›å¿†</span>
      </div>
   </div>

   <div class="content">
      <p>æˆ‘çœŸçš„æœ‰åœ¨å˜,ä¸€ç›´åœ¨å˜<br>
ä¸åƒæ˜¯é‚£ç§çªç„¶çš„,ä¸€ç¬é—´çš„.è€Œæ˜¯ä½ èƒ½å¤Ÿæ„Ÿè§‰åˆ°,æ…¢æ…¢çš„,æ…¢æ…¢çš„.å¾ˆå¤šä¸œè¥¿éƒ½å˜äº†<br>
æ¸æ¸çš„,æˆ‘ä¹Ÿæ·¡æ¼ äº†<br>
æˆ‘æ›¾å¥½åƒå¾ˆå¤©çœŸ,æˆ‘è¿‡å»ä¼¼ä¹ä»€ä¹ˆéƒ½ç›¸ä¿¡,ä»€ä¹ˆéƒ½å¸Œå†€<br>
ç°åœ¨ä¸æ˜¯äº†...</p>
<p>ç›´åˆ°å‡ å¤©å‰å»å¤–å©†å®¶,å¥¹ä»¬åˆæèµ·äº†ä¸€äº›å¾€äº‹.é—®æˆ‘,ç„¶è€Œæˆ‘å´ä»€ä¹ˆä¹Ÿæƒ³ä¸èµ·æ¥<br>
æˆ‘æ˜¯çœŸçš„ä¸è®°å¾—äº†...ä»€ä¹ˆéƒ½è®°ä¸èµ·æ¥</p>
<p>æ®è¯´,äººåœ¨å—åˆ°é‡å¤§æ‰“å‡»çš„æ—¶å€™.å¤§è„‘ä¼šé€‰æ‹©æ€§çš„å¤±å¿†æ¥ä¿æŠ¤ä½ ,æˆ‘åƒæ˜¯è¿™æ ·çš„å—?æˆ‘ä¼¼ä¹ä»€ä¹ˆä¹Ÿä¸åœ¨æ„,ç„¶è€Œå¥½åƒåˆåœ¨æ„ä¸€åˆ‡</p>
<p>"è´Ÿè´£"<br>
Duty,æˆ‘æ²‰é»˜äº†.åŸæ¥æ˜¯å› ä¸ºè´Ÿè´£,ä¹Ÿå°±åƒä½ åœ¨å¯¹ç€ç©ºè°·å˜¶å¼,å´æœŸç›¼ç€èƒ½å¤Ÿå¬åˆ°å›å“<br>
......<br>
ä¸è¿‡èƒ½å¤Ÿè¯´ä»€ä¹ˆå‘¢?è‡³å°‘èƒ½å¤Ÿè¯æ˜ABCæ˜¯ä¸€ä¸ªè´Ÿè´£ä»»çš„äºº,è‡³å°‘èƒ½å¤Ÿè¯´æ˜,ABCå¾ˆæœ‰è´£ä»»å¿ƒ<br>
......</p>
<p>æˆ‘åˆæƒ³åˆ°æˆ‘äº†<br>
æˆ‘æƒ³åˆ°äº†æˆå¹´,æˆ‘æƒ³åˆ°äº†ä¸€ç¾¤äººåœ¨ç¬‘,æˆ‘æƒ³åˆ°äº†"æˆäººç¤¼",æˆ‘æƒ³åˆ°äº†"å­˜åœ¨",æˆ‘æƒ³åˆ°äº†"å®¶äºº",æˆ‘æƒ³åˆ°äº†"Friends"<br>
......<br>
ä¸è¿‡å¥½åƒæ¯ä¸€ä»¶éƒ½ä¸æˆ‘æ¯«æ— å…³ç³»,æˆ‘çªç„¶åˆå¤±è½äº†èµ·æ¥,è¿™æ˜¯å¤±è½å—?å¦‚æœèƒ½å¤Ÿç§°ä¹‹ä¸º"æ˜¯"çš„è¯<br>
æˆ‘åˆå“­äº†...<br>
ä¸è¿‡å€’æ²¡æœ‰çœŸçš„å“­,æˆ‘çš„è„‘å­å·²ç»å“­å®Œäº†.ä½†æ˜¯æˆ‘çš„Bodyè¡¨ç¤ºä¸åƒè¿™ä¸€å¥—,æ²¡åŠæ³•,å°±å¥½åƒè‡ªå·±ç²¾ç¥åˆ†è£‚äº†ä¸€æ ·,åŠæˆªæ˜¯åŠæˆª</p>
<p>?</p>
   </div>

   <div class="comments"></div>

   <button class="floating-btn" id="menuToggle" style="color: #fff">â˜°</button>

   <div class="menu-mask" id="menuMask"></div>

   <div class="side-menu-wrapper" id="sideMenuWrapper">
      <div class="side-menu" id="sideMenu">
         <div class="menu-left" id="chapterList"></div>
         <div class="menu-right" id="menuRightEl">
            <div class="menu-buttons">
               <button class="menu-btn" id="toBottomBtn">â–¼</button>
               <button class="menu-btn" id="middleBtn">â—</button>
               <button class="menu-btn" id="toTopBtn">â–²</button>
            </div>
            <button class="close-btn" id="closeBtn">â•³</button>
         </div>
      </div>
   </div>

   <canvas id="menuRevealCanvas"></canvas>

   <script>
     const menuToggle      = document.getElementById('menuToggle');
     const sideMenuWrapper = document.getElementById('sideMenuWrapper');
     const sideMenu        = document.getElementById('sideMenu');
     const menuMask        = document.getElementById('menuMask');
     const closeBtn        = document.getElementById('closeBtn');
     const toBottomBtn     = document.getElementById('toBottomBtn');
     const middleBtn       = document.getElementById('middleBtn');
     const toTopBtn        = document.getElementById('toTopBtn');
     const chapterList     = document.getElementById('chapterList');
     // chapterList å³ .menu-leftï¼Œç»Ÿä¸€ä½¿ç”¨ chapterList å¼•ç”¨
     const menuRightEl     = document.getElementById('menuRightEl');

     // ==================== æ¡Œé¢/ç§»åŠ¨ç«¯æ£€æµ‹ ====================
     const isDesktop = window.matchMedia('(hover: hover) and (pointer: fine)').matches;
     if (isDesktop) document.body.classList.add('is-desktop');

     // === 1. æ”¶é›† h1/h2/h3ï¼Œç”Ÿæˆå”¯ä¸€ ID ===
     const allHeadings = Array.from(
       document.querySelectorAll('.content h1, .content h2, .content h3')
     ).filter(h => h.textContent.trim() !== '');

     allHeadings.forEach((el, index) => {
       el.id = `heading-${index}`;
     });

     // === 2. åº”ç”¨ä¸»é¢˜ ===
     function applyTheme() {
       const savedTheme  = localStorage.getItem('theme');
       const configTheme = "dark";
       const mode = savedTheme || configTheme;
       document.body.classList.toggle('light-mode', mode === 'light');
       document.body.classList.toggle('dark-mode',  mode !== 'light');
       // åŒæ­¥ floating-btn é¢œè‰²
       menuToggle.style.color = mode === 'light' ? '#000' : '#fff';
     }
     applyTheme();

     // === 3. ç”Ÿæˆç« èŠ‚å¯¼èˆª ===
     allHeadings.forEach(heading => {
       const listItem  = document.createElement('div');
       const level     = parseInt(heading.tagName.substring(1));
       const classMap  = { 1: 'h1-item', 2: 'h2-item', 3: 'h3-item' };
       listItem.className   = `chapter-item ${classMap[level] || 'h1-item'}`;
       listItem.textContent = heading.textContent;
       listItem.dataset.id  = heading.id;

       listItem.addEventListener('click', (e) => {
         e.stopPropagation();
         heading.scrollIntoView({ behavior: 'smooth', block: 'start' });
         closeMenu();
       });

       // æ‚¬åœï¼šä»…æ¡Œé¢é¼ æ ‡è§¦å‘
       if (isDesktop) {
         listItem.addEventListener('pointerenter', (e) => {
           if (e.pointerType !== 'mouse') return;
           onItemPointerEnter(listItem);
         });
         listItem.addEventListener('pointerleave', (e) => {
           if (e.pointerType !== 'mouse') return;
           onItemPointerLeave();
         });
       }

       chapterList.appendChild(listItem);
     });

     // ==================== é«˜äº®çŠ¶æ€æœº ====================
     // ä¸‰ä¸ªäº’æ–¥çŠ¶æ€ï¼šscrollï¼ˆæ»šåŠ¨é©±åŠ¨ï¼‰| hoverï¼ˆé¼ æ ‡æ‚¬åœï¼‰| menuï¼ˆèœå•åˆ—è¡¨æ»‘åŠ¨ï¼‰

     let currentId        = null;  // æ–‡ç« æ»šåŠ¨é©±åŠ¨çš„å½“å‰æ ‡é¢˜ id
     let hoveredItem      = null;  // é¼ æ ‡æ‚¬åœçš„ chapter-item å…ƒç´ 
     let activeState      = 'scroll';

     let hoverScrollTimer = null;  // æ‚¬åœåå±…ä¸­çš„é˜²æŠ–
     let menuScrollTimer  = null;  // èœå•æ»šåŠ¨åœæ­¢åå¯¹é½çš„é˜²æŠ–
     let cooldownTimer    = null;  // å±…ä¸­å 5 ç§’å†·å´è®¡æ—¶å™¨
     let isInCooldown     = false; // æ˜¯å¦å¤„äºå†·å´æœŸï¼ˆå±…ä¸­å 5 ç§’å†…ç¦æ­¢å†æ¬¡å±…ä¸­ï¼‰
     let isMenuScrolling  = false;
     let isProgrammaticScroll  = false; // ä»£ç é©±åŠ¨çš„èœå•æ»šåŠ¨ï¼Œä¸è§¦å‘ menu çŠ¶æ€
     let isMenuDrivingArticle  = false; // èœå•é©±åŠ¨æ–‡ç« æ»šåŠ¨æœŸé—´ï¼Œå±è”½æ–‡ç«  scroll åå‘è§¦å‘

     // å”¯ä¸€å…¥å£ï¼šè®¾ç½®é«˜äº®åˆ°æŒ‡å®š id
     function setHighlight(id) {
       document.querySelectorAll('.chapter-item.current, .chapter-item.hovered')
         .forEach(i => i.classList.remove('current', 'hovered'));
       if (!id) return;
       const item = document.querySelector(`.chapter-item[data-id="${id}"]`);
       if (item) item.classList.add(activeState === 'scroll' ? 'current' : 'hovered');
     }

     // æ»šåŠ¨èœå•è®©æŒ‡å®š item å±…ä¸­
     function scrollMenuToItem(id, behavior = 'smooth') {
       const item = document.querySelector(`.chapter-item[data-id="${id}"]`);
       if (!item) return;
       const itemTop    = item.offsetTop;
       const itemHeight = item.offsetHeight;
       const containerH = chapterList.clientHeight;
       const target     = itemTop - (containerH - itemHeight) / 2;
       if (chapterList.scrollHeight > containerH) {
         isProgrammaticScroll = true;
         chapterList.scrollTo({ top: Math.max(0, target), behavior });
         // smooth æ»šåŠ¨æ— æ³•ç²¾ç¡®å¾—çŸ¥ä½•æ—¶ç»“æŸï¼Œç”¨ä¿å®ˆçš„è¶…æ—¶å…œåº•æ¸…é™¤æ ‡å¿—
         setTimeout(() => { isProgrammaticScroll = false; }, 600);
       }
     }

     // æ‰¾èœå•åˆ—è¡¨ä¸­æœ€é è¿‘è§†å£ä¸­å¿ƒçš„ item çš„ id
     function getCenteredItemId() {
       const items      = chapterList.querySelectorAll('.chapter-item');
       const containerR = chapterList.getBoundingClientRect();
       const centerY    = containerR.top + containerR.height / 2;
       let best = null, bestDist = Infinity;
       items.forEach(item => {
         const r    = item.getBoundingClientRect();
         const mid  = r.top + r.height / 2;
         const dist = Math.abs(mid - centerY);
         if (dist < bestDist) { bestDist = dist; best = item; }
       });
       return best ? best.dataset.id : null;
     }

     // === çŠ¶æ€ï¼šscrollï¼ˆæ–‡ç« æ»šåŠ¨é©±åŠ¨ï¼‰===
     function applyScrollState(id) {
       if (activeState === 'hover' || activeState === 'menu') return;
       activeState = 'scroll';
       currentId   = id;
       setHighlight(id);
       if (!isMenuScrolling) scrollMenuToItem(id);
     }

     function updateActiveHeading() {
       if (allHeadings.length === 0) return;
       if (isMenuDrivingArticle) return; // èœå•é©±åŠ¨æ–‡ç« æœŸé—´ï¼Œå±è”½åå‘è§¦å‘
       const scrollY = window.scrollY;
       const offset  = 80;
       let current   = allHeadings[0];
       for (let i = 0; i < allHeadings.length; i++) {
         const top = allHeadings[i].getBoundingClientRect().top + scrollY;
         if (top <= scrollY + offset) current = allHeadings[i];
         else break;
       }
       if (current.id !== currentId || activeState !== 'scroll') {
         applyScrollState(current.id);
       }
     }

     if (allHeadings.length > 0) {
       currentId = allHeadings[0].id;
       applyScrollState(currentId);
     }

     window.addEventListener('scroll', updateActiveHeading, { passive: true });

     // === çŠ¶æ€ï¼šhoverï¼ˆé¼ æ ‡æ‚¬åœï¼Œä»…æ¡Œé¢ï¼‰===

     function startCooldown() {
       isInCooldown = true;
       clearTimeout(cooldownTimer);
       cooldownTimer = setTimeout(() => {
         isInCooldown = false;
       }, 5000);
     }

     function clearCooldown() {
       isInCooldown = false;
       clearTimeout(cooldownTimer);
       cooldownTimer = null;
     }

     function onItemPointerEnter(item) {
       // è¿›å…¥ hover çŠ¶æ€
       hoveredItem = item;
       activeState = 'hover';
       setHighlight(item.dataset.id);

       // å†·å´æœŸå†…ï¼šé«˜äº®è·Ÿéšï¼Œä½†ä¸è§¦å‘å±…ä¸­é˜²æŠ–
       if (isInCooldown) return;

       // éå†·å´æœŸï¼šé˜²æŠ– 350ms åå±…ä¸­
       clearTimeout(hoverScrollTimer);
       hoverScrollTimer = setTimeout(() => {
         // å†æ¬¡æ£€æŸ¥ï¼šå¦‚æœå·²é€€å‡º hover çŠ¶æ€åˆ™å–æ¶ˆ
         if (activeState !== 'hover' || hoveredItem !== item) return;
         scrollMenuToItem(item.dataset.id);
         startCooldown();
       }, 350);
     }

     function onItemPointerLeave() {
       // ç«‹å³æ¸…é™¤é˜²æŠ–è®¡æ—¶å™¨ï¼Œä½†ä¿ç•™å†·å´æœŸï¼ˆè®©5ç§’å†·å´è‡ªç„¶è¶…æ—¶ï¼‰
       clearTimeout(hoverScrollTimer);
       hoverScrollTimer = null;
       hoveredItem = null;
       // æ¢å¤æ»šåŠ¨é©±åŠ¨çŠ¶æ€
       activeState = 'scroll';
       setHighlight(currentId);
       // å°†èœå•æ»šå›å½“å‰æ»šåŠ¨é©±åŠ¨çš„ item
       scrollMenuToItem(currentId);
     }

     // é¼ æ ‡ç¦»å¼€æ•´ä¸ª menu-left åŒºåŸŸæ—¶å¼ºåˆ¶é€€å‡º hover
     if (isDesktop) {
       chapterList.addEventListener('pointerleave', (e) => {
         if (e.pointerType !== 'mouse') return;
         if (activeState === 'hover') {
           onItemPointerLeave();
         }
       });
     }

     // === çŠ¶æ€ï¼šmenuï¼ˆèœå•åˆ—è¡¨æ»‘åŠ¨ï¼‰===
     chapterList.addEventListener('scroll', () => {
       // ç¨‹åºé©±åŠ¨çš„æ»šåŠ¨ä¸è§¦å‘ menu çŠ¶æ€ï¼›hover æœŸé—´å¿½ç•¥
       if (isProgrammaticScroll) return;
       if (activeState === 'hover') return;
       isMenuScrolling = true;
       activeState = 'menu';

       clearTimeout(menuScrollTimer);
       menuScrollTimer = setTimeout(() => {
         isMenuScrolling = false;
         const centerId = getCenteredItemId();
         if (centerId) {
           scrollMenuToItem(centerId);
           setTimeout(() => {
             if (activeState === 'menu' && !hoveredItem) {
               setHighlight(centerId);

               // é©±åŠ¨æ–‡ç« æ»šåŠ¨åˆ°å¯¹åº”æ ‡é¢˜
               const targetHeading = document.getElementById(centerId);
               if (targetHeading) {
                 isMenuDrivingArticle = true;
                 currentId = centerId; // æå‰åŒæ­¥ï¼Œé˜²æ­¢å›å½’ scroll æ—¶é«˜äº®é—ªçƒ
                 targetHeading.scrollIntoView({ behavior: 'smooth', block: 'start' });
                 setTimeout(() => { isMenuDrivingArticle = false; }, 800);
               }

               // 1.5 ç§’åæ— æ“ä½œåˆ™å›å½’ scroll çŠ¶æ€
               setTimeout(() => {
                 if (activeState === 'menu' && !hoveredItem) {
                   activeState = 'scroll';
                   setHighlight(currentId);
                   scrollMenuToItem(currentId);
                 }
               }, 1500);
             }
           }, 300);
         }
       }, 70); // é˜²æŠ–æ—¶é—´
     }, { passive: true });

     // ç§»åŠ¨ç«¯è§¦æ‘¸ç»“æŸ/å–æ¶ˆï¼šæ¸…é™¤ä»»ä½•æ®‹ç•™çš„ hover çŠ¶æ€ï¼ˆå…œåº•ï¼‰
     // ç§»åŠ¨ç«¯æ²¡æœ‰ hover çŠ¶æ€ï¼Œè¿™é‡Œåªæ˜¯ä¿é™©
     chapterList.addEventListener('touchend',    () => {
       if (hoveredItem) { hoveredItem = null; }
     });
     chapterList.addEventListener('touchcancel', () => {
       if (hoveredItem) { hoveredItem = null; }
     });

     // === 4. èœå•æ§åˆ¶ ===
     function openMenu() {
       sideMenuWrapper.classList.add('active');
       sideMenu.classList.add('active');
       menuMask.classList.add('active');
       menuToggle.style.display = 'none';
       if (currentId) scrollMenuToItem(currentId, 'instant');
       // æ‰“å¼€æ—¶åˆ·æ–° canvas å°ºå¯¸
       if (isDesktop) resizeCanvas();
     }

     function closeMenu() {
       sideMenuWrapper.classList.remove('active');
       sideMenu.classList.remove('active');
       menuMask.classList.remove('active');
       menuToggle.style.display = 'flex';
       // å…³é—­èœå•æ—¶ï¼šæ¸…é™¤æ‰€æœ‰ hover/æ‚¬åœçŠ¶æ€å’Œ canvas
       if (isDesktop) {
         clearAllReveal();
         if (activeState === 'hover') {
           clearTimeout(hoverScrollTimer);
           clearCooldown();
           hoveredItem  = null;
           activeState  = 'scroll';
           setHighlight(currentId);
         }
       }
     }

     menuToggle.addEventListener('click',  (e) => { e.stopPropagation(); openMenu(); });
     closeBtn.addEventListener('click',    (e) => { e.stopPropagation(); closeMenu(); });
     menuMask.addEventListener('click',    (e) => { e.stopPropagation(); closeMenu(); });
     sideMenu.addEventListener('click',    (e) => e.stopPropagation());

     toBottomBtn.addEventListener('click', (e) => {
       e.stopPropagation();
       window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
       closeMenu();
     });

     middleBtn.addEventListener('click', (e) => {
       e.stopPropagation();
       const middle = (document.documentElement.scrollHeight - window.innerHeight) / 2;
       window.scrollTo({ top: middle, behavior: 'smooth' });
       closeMenu();
     });

     toTopBtn.addEventListener('click', (e) => {
       e.stopPropagation();
       window.scrollTo({ top: 0, behavior: 'smooth' });
       closeMenu();
     });

     // === 5. æ»šåŠ¨è¿›åº¦æŒ‡ç¤ºå™¨ ===
     function updateProgress() {
       const scrollHeight   = document.documentElement.scrollHeight - window.innerHeight;
       const scrollPosition = window.scrollY;
       const scrollPercent  = scrollHeight > 0 ? Math.min(scrollPosition / scrollHeight, 1) : 0;
       const redValue       = Math.floor(scrollPercent * 255);
       menuToggle.style.backgroundColor = `rgb(${redValue}, 0, 0)`;
       menuToggle.style.boxShadow       = 'none';
     }

     window.addEventListener('scroll', updateProgress, { passive: true });
     window.addEventListener('resize', updateProgress, { passive: true });
     updateProgress();

     // ==================== Reveal Highlightï¼ˆä»…æ¡Œé¢ï¼‰====================
     if (isDesktop) {

       const canvas = document.getElementById('menuRevealCanvas');
       const ctx    = canvas.getContext('2d');

       // ç¼“å­˜çš„ canvas ä½ç½®ï¼Œé¿å…æ¯å¸§éƒ½ getBoundingClientRect
       let cachedMenuRect = null;

       function resizeCanvas() {
         if (!sideMenuWrapper.classList.contains('active')) return;
         const r = chapterList.getBoundingClientRect();
         canvas.width  = r.width;
         canvas.height = r.height;
         canvas.style.left = r.left + 'px';
         canvas.style.top  = r.top  + 'px';
         cachedMenuRect = r;
       }

       // èœå•åˆ—è¡¨æ»šåŠ¨æ—¶ï¼Œé‡æ–°åŒæ­¥ canvas ä½ç½®ï¼ˆåˆ†å‰²çº¿ä½ç½®å˜äº†ï¼‰
       chapterList.addEventListener('scroll', () => {
         if (sideMenuWrapper.classList.contains('active')) {
           // ç”¨ rAF é¿å…æ»šåŠ¨æœŸé—´é¢‘ç¹ reflow
           requestAnimationFrame(() => {
             resizeCanvas();
             // æ¸…ç©º canvasï¼Œå…‰æ•ˆåœ¨ä¸‹æ¬¡ mousemove æ—¶é‡ç»˜
             ctx.clearRect(0, 0, canvas.width, canvas.height);
           });
         }
       }, { passive: true });

       // ç”»ç« èŠ‚åˆ†éš”çº¿å‘å…‰
       function drawDividerGlow(mouseX, mouseY) {
         ctx.clearRect(0, 0, canvas.width, canvas.height);
         if (!sideMenuWrapper.classList.contains('active')) return;

         const style    = getComputedStyle(document.body);
         const colorHi  = style.getPropertyValue('--reveal-hi').trim();
         const colorMid = style.getPropertyValue('--reveal-mid').trim();

         // æ¯å¸§å®æ—¶å–ä½ç½®ï¼Œä¿è¯å‡ºç°åŠ¨ç”»/æ»šåŠ¨å canvas ç«‹å³å¯¹é½
         const menuRect = chapterList.getBoundingClientRect();
         if (canvas.width  !== Math.round(menuRect.width)  ||
             canvas.height !== Math.round(menuRect.height) ||
             parseFloat(canvas.style.left) !== menuRect.left ||
             parseFloat(canvas.style.top)  !== menuRect.top) {
           canvas.width      = menuRect.width;
           canvas.height     = menuRect.height;
           canvas.style.left = menuRect.left + 'px';
           canvas.style.top  = menuRect.top  + 'px';
           cachedMenuRect    = menuRect;
         }
         const items    = chapterList.querySelectorAll('.chapter-item:not(:last-child)');
         const radius   = 80;

         const mdx   = Math.max(menuRect.left - mouseX, 0, mouseX - menuRect.right);
         const mdy   = Math.max(menuRect.top  - mouseY, 0, mouseY - menuRect.bottom);
         const mdist = Math.sqrt(mdx * mdx + mdy * mdy);
         if (mdist > radius) return;

         items.forEach(item => {
           // å®æ—¶è·å– item çš„ä½ç½®ï¼ˆè€ƒè™‘åˆ—è¡¨æ»šåŠ¨ï¼‰
           const itemRect  = item.getBoundingClientRect();
           const lineY     = itemRect.bottom - menuRect.top;
           const lineLeft  = itemRect.left  - menuRect.left + 8;
           const lineRight = itemRect.right - menuRect.left - 8;

           // è·³è¿‡ä¸åœ¨ canvas å¯è§åŒºåŸŸå†…çš„åˆ†å‰²çº¿
           if (lineY < 0 || lineY > canvas.height) return;

           const nearestX  = Math.max(lineLeft, Math.min(mouseX - menuRect.left, lineRight));
           const dist      = Math.hypot(
             mouseX - menuRect.left - nearestX,
             mouseY - menuRect.top  - lineY
           );

           if (dist > radius) return;

           const intensity = 1 - dist / radius;
           const gx   = mouseX - menuRect.left;
           const grad = ctx.createRadialGradient(gx, lineY, 0, gx, lineY, radius);
           grad.addColorStop(0,   `rgba(${colorHi},${1.0 * intensity})`);
           grad.addColorStop(0.4, `rgba(${colorMid},${0.65 * intensity})`);
           grad.addColorStop(1,   `rgba(${colorMid},0)`);

           ctx.beginPath();
           ctx.moveTo(lineLeft,  lineY);
           ctx.lineTo(lineRight, lineY);
           ctx.lineWidth   = 1;
           ctx.strokeStyle = grad;
           ctx.stroke();
         });
       }

       const revealTargets = [
         { el: menuToggle,       range: 60,  alwaysOn: true  },
         { el: sideMenuWrapper,  range: 80,  alwaysOn: false },
         { el: chapterList,      range: 80,  alwaysOn: false },
         { el: menuRightEl,      range: 80,  alwaysOn: false },
       ];

       function clearAllReveal() {
         revealTargets.forEach(({ el }) => {
           el?.style.setProperty('--rx', '-9999px');
           el?.style.setProperty('--ry', '-9999px');
         });
         ctx.clearRect(0, 0, canvas.width, canvas.height);
         canvas.classList.remove('active');
       }

       function handleMove(e) {
         // åªå¤„ç†é¼ æ ‡äº‹ä»¶
         if (e.pointerType && e.pointerType !== 'mouse') return;
         const menuActive = sideMenuWrapper.classList.contains('active');

         revealTargets.forEach(({ el, range, alwaysOn }) => {
           if (!el) return;
           if (!alwaysOn && !menuActive) {
             el.style.setProperty('--rx', '-9999px');
             el.style.setProperty('--ry', '-9999px');
             return;
           }
           const r    = el.getBoundingClientRect();
           const dx   = Math.max(r.left - e.clientX, 0, e.clientX - r.right);
           const dy   = Math.max(r.top  - e.clientY, 0, e.clientY - r.bottom);
           const dist = Math.sqrt(dx * dx + dy * dy);
           if (dist <= range) {
             el.style.setProperty('--rx', (e.clientX - r.left) + 'px');
             el.style.setProperty('--ry', (e.clientY - r.top)  + 'px');
           } else {
             el.style.setProperty('--rx', '-9999px');
             el.style.setProperty('--ry', '-9999px');
           }
         });

         // æ›´æ–° canvas åˆ†éš”çº¿å‘å…‰
         if (menuActive) {
           // åªåœ¨ cachedMenuRect ä¸å­˜åœ¨æ—¶æ‰ resizeï¼ˆæ‰“å¼€æ—¶å·²ç»ç¼“å­˜äº†ï¼‰
           if (!cachedMenuRect) resizeCanvas();
           canvas.classList.add('active');
           drawDividerGlow(e.clientX, e.clientY);
         }
       }

       // åªç»‘å®š pointermoveï¼Œå»æ‰é‡å¤çš„ mousemove
       document.addEventListener('pointermove',  handleMove);
       document.addEventListener('pointerup',    handleMove);
       document.addEventListener('pointerleave', clearAllReveal);
       window.addEventListener('blur',           clearAllReveal);

       // resize æ—¶åŒæ­¥ canvas å°ºå¯¸
       window.addEventListener('resize', () => {
         cachedMenuRect = null;
         resizeCanvas();
         updateProgress();
       });

     } // end isDesktop

   </script>

</body>

</html>